<!DOCTYPE html><html><head><meta charset="UTF-8" name="viewport" content="width=device-width"><title>第四代Lemon自动AC机 - su226的博客</title><meta name="generator" content="Hexo 6.2.0"><meta name="description" content="BGM！  第二、三代？ 第一代实际上是我第一次使用的版本，由于不兼容Linux，爆零。Bugs:  不兼容Linux 使用复杂 数据文件名格式不标准会出错   第二代就是这篇文章的版本。修改:  使用基于字符串而不是数据的对比 兼容Linux  Bugs:  数据文件名格式不标准会出错 在某个输入是另一个输入的前缀时会出错   第三代是我在今天的模拟赛趁着老师不在时写的。修改:  加入基于随机数"><meta property="og:type" content="article"><meta property="og:title" content="第四代Lemon自动AC机"><meta property="og:url" content="https://su226.tk/2019/08/25/lemon-autoac-v4/index.html"><meta property="og:site_name" content="su226的博客"><meta property="og:description" content="BGM！  第二、三代？ 第一代实际上是我第一次使用的版本，由于不兼容Linux，爆零。Bugs:  不兼容Linux 使用复杂 数据文件名格式不标准会出错   第二代就是这篇文章的版本。修改:  使用基于字符串而不是数据的对比 兼容Linux  Bugs:  数据文件名格式不标准会出错 在某个输入是另一个输入的前缀时会出错   第三代是我在今天的模拟赛趁着老师不在时写的。修改:  加入基于随机数"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-08-24T16:00:00.000Z"><meta property="article:modified_time" content="2019-08-24T16:00:00.000Z"><meta property="article:author" content="su226"><meta property="article:tag" content="OI"><meta property="article:tag" content="C++"><meta name="twitter:card" content="summary"><link rel="stylesheet" href="/css/normalize-8.0.1-min.css"><link rel="stylesheet" href="/css/waves-0.7.6-min.css"><link rel="stylesheet" href="/css/base.css"><link rel="stylesheet" href="/css/colors.css"><link rel="stylesheet" href="/css/info.css"><link rel="stylesheet" href="/css/post.css"></head><body><nav class="sidebar"><div class="sidebar-header color-blue"><img class="sidebar-avatar" src="https://avatars.githubusercontent.com/u/17371317?s=112"> <span class="sidebar-title">su226的博客</span> <span class="sidebar-subtitle">汪汪汪！（发出逼真的猫叫声） </span><button id="settings" class="btn-icon"><span class="iconify" data-icon="mdi:cog"></span></button></div><ul class="menu" id="menu"><li class="menu-item"><span class="menu-icon iconify" data-icon="mdi:home"></span> <a class="menu-link" href="/">主页</a></li><li class="menu-item"><span class="menu-icon iconify" data-icon="mdi:file-document"></span> <a class="menu-link" href="/archives">文章</a></li><li class="menu-item"><span class="menu-icon iconify" data-icon="mdi:magnify"></span> <a class="menu-link" href="/search">搜索</a></li><li class="menu-item"><span class="menu-icon iconify" data-icon="mdi:view-grid"></span> <a class="menu-link" href="/apps/">应用</a></li><li class="menu-item"><span class="menu-icon iconify" data-icon="ri:bilibili-fill"></span> <a class="menu-link" target="_blank" rel="noopener" href="https://space.bilibili.com/14334962">Bilibili</a></li><li class="menu-item"><span class="menu-icon iconify" data-icon="mdi:github-circle"></span> <a class="menu-link" target="_blank" rel="noopener" href="https://github.com/su226">GitHub</a></li></ul></nav><div class="navbar-fixed"><nav class="navbar color-lime"><button class="btn-icon" id="toggle-menu"><span class="iconify" data-icon="mdi:menu"></span></button><div class="navbar-title">第四代Lemon自动AC机</div><button class="btn-icon" id="back-to-top"><span class="iconify" data-icon="mdi:arrow-up"></span></button></nav></div><div id="content"><div id="i18n-data-post" class="i18n-data" data-tab-menu="菜单" data-tab-toc="目录" data-comment-unsupported="抱歉，你的浏览器太旧了，不支持评论区。（评论区至少需要 Chrome 71 / Firefox 65 / Edge 79）"></div><article class="post"><div class="post-header color-lime"><div class="container"><h1 class="post-title">第四代Lemon自动AC机</h1><div class="post-info"><span class="iconify" data-icon="mdi:calendar"></span><ul class="post-date"><li><a href="/archives/2019">2019</a></li><li><a href="/archives/2019/08">8</a></li><li>25</li></ul><div class="post-info-wrap"></div><span class="iconify" data-icon="mdi:folder"></span><ul class="post-categories"><li><a href="/categories/%E8%BD%AF%E4%BB%B6/">软件</a></li></ul><span class="iconify" data-icon="mdi:tag"></span><ul class="post-tags"><li><a class="chip" href="/tags/OI/">OI</a></li><li><a class="chip" href="/tags/C/">C++</a></li></ul></div></div></div><div class="toc" id="toc"><a class="toc-header toc-link" href="#content">第四代Lemon自动AC机</a><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#BGM%EF%BC%81"><span class="toc-text">BGM！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E3%80%81%E4%B8%89%E4%BB%A3%EF%BC%9F"><span class="toc-text">第二、三代？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-text">代码</span></a></li></ol></div><div class="post-background"><div class="post-content container"><h2 id="BGM！"><a href="#BGM！" class="headerlink" title="BGM！"></a>BGM！</h2><iframe src="https://music.163.com/outchain/player?type=2&id=27901184&auto=1&height=66"></iframe><h2 id="第二、三代？"><a href="#第二、三代？" class="headerlink" title="第二、三代？"></a>第二、三代？</h2><ul><li><p>第一代实际上是我第一次使用的版本，由于不兼容Linux，爆零。<br>Bugs:</p><ul><li>不兼容Linux</li><li>使用复杂</li><li>数据文件名格式不标准会出错</li></ul></li><li><p>第二代就是<a href="/2019/08/24/lemon-autoac/">这篇文章</a>的版本。<br>修改:</p><ul><li>使用基于字符串而不是数据的对比</li><li>兼容Linux</li></ul><p>Bugs:</p><ul><li>数据文件名格式不标准会出错</li><li>在某个输入是另一个输入的前缀时会出错</li></ul></li><li><p>第三代是我在今天的模拟赛趁着老师不在时写的。<br>修改:</p><ul><li>加入基于随机数的(半自动)混淆</li><li>修复在某个输入是另一个输入的前缀时的出错</li></ul><p>Bugs:</p><ul><li>数据文件名格式不标准会出错</li></ul></li><li><p>然后我推出了——第四代！<br>修改:</p><ul><li>直接枚举文件而不是枚举测试点，使用<code>std::set</code>存储</li><li>不再使用<code>std::ostringstream</code>格式化字符串</li><li>依赖于<code>io.h</code>(Windows)和<code>dirent.h</code>(Linux)</li></ul></li></ul><h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2><p><code>lemon-autoac.cpp</code>: 未混淆的代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;set&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _WIN32</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;io.h&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* datapath = <span class="string">&quot;..\\..\\data\\&quot;</span>;</span><br><span class="line"><span class="function">std::set&lt;std::string&gt; <span class="title">scan</span><span class="params">(<span class="type">const</span> std::string&amp; dirname)</span> </span>&#123;</span><br><span class="line">  <span class="type">_finddata_t</span> file;</span><br><span class="line">  std::set&lt;std::string&gt; ret;</span><br><span class="line">  <span class="type">intptr_t</span> dir = _findfirst((dirname + <span class="string">&quot;\\*&quot;</span>).<span class="built_in">c_str</span>(), &amp;file);</span><br><span class="line">  <span class="keyword">while</span> (!_findnext(dir, &amp;file)) &#123;</span><br><span class="line">    std::string filename = file.name;</span><br><span class="line">    <span class="keyword">if</span> (filename.<span class="built_in">length</span>() &gt; <span class="number">3</span> &amp;&amp; filename.<span class="built_in">substr</span>(filename.<span class="built_in">length</span>() - <span class="number">3</span>) == <span class="string">&quot;.in&quot;</span>) &#123;</span><br><span class="line">      std::string path = dirname + <span class="string">&#x27;\\&#x27;</span> + filename;</span><br><span class="line">      ret.<span class="built_in">insert</span>(path.<span class="built_in">substr</span>(<span class="number">0</span>, path.<span class="built_in">length</span>() - <span class="number">3</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  _findclose(dir);</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;dirent.h&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span>* datapath = <span class="string">&quot;../../data/&quot;</span>;</span><br><span class="line"><span class="function">std::set&lt;std::string&gt; <span class="title">scan</span><span class="params">(<span class="type">const</span> std::string&amp; dirname)</span> </span>&#123;</span><br><span class="line">  DIR* dir = <span class="built_in">opendir</span>(dirname.<span class="built_in">c_str</span>());</span><br><span class="line">  std::set&lt;std::string&gt; ret;</span><br><span class="line">  <span class="keyword">for</span> (dirent* file = <span class="built_in">readdir</span>(dir); file != <span class="literal">NULL</span>; file = <span class="built_in">readdir</span>(dir)) &#123;</span><br><span class="line">    std::string filename = file-&gt;d_name;</span><br><span class="line">    <span class="keyword">if</span> (filename.<span class="built_in">length</span>() &gt; <span class="number">3</span> &amp;&amp; filename.<span class="built_in">substr</span>(filename.<span class="built_in">length</span>() - <span class="number">3</span>) == <span class="string">&quot;.in&quot;</span>) &#123;</span><br><span class="line">      std::string path = dirname + <span class="string">&#x27;/&#x27;</span> + filename;</span><br><span class="line">      ret.<span class="built_in">insert</span>(path.<span class="built_in">substr</span>(<span class="number">0</span>, path.<span class="built_in">length</span>() - <span class="number">3</span>));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">closedir</span>(dir);</span><br><span class="line">  <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="type">const</span> std::string probname = <span class="string">&quot;$PROBLEM_NAME$&quot;</span>;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check_stream</span><span class="params">(std::istream&amp; fin, std::istream&amp; tin)</span> </span>&#123;</span><br><span class="line">  fin.<span class="built_in">seekg</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">char</span> ch = fin.<span class="built_in">get</span>(), ch2 = tin.<span class="built_in">get</span>(); ch != <span class="number">-1</span> || ch2 != <span class="number">-1</span>; ch = fin.<span class="built_in">get</span>(), ch2 = tin.<span class="built_in">get</span>()) &#123;</span><br><span class="line">    <span class="keyword">if</span> (ch != ch2) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="function">std::ifstream <span class="title">fin</span><span class="params">((probname + <span class="string">&quot;.in&quot;</span>).c_str())</span></span>;</span><br><span class="line">  <span class="function">std::ofstream <span class="title">fout</span><span class="params">((probname + <span class="string">&quot;.out&quot;</span>).c_str())</span></span>;</span><br><span class="line">  std::set&lt;std::string&gt; filelist = <span class="built_in">scan</span>(datapath + probname);</span><br><span class="line">  <span class="keyword">for</span> (std::set&lt;std::string&gt;::iterator i = filelist.<span class="built_in">begin</span>(), i_ = filelist.<span class="built_in">end</span>(); i != i_; i++) &#123;</span><br><span class="line">    <span class="function">std::ifstream <span class="title">tin</span><span class="params">((*i + <span class="string">&quot;.in&quot;</span>).c_str())</span></span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">check_stream</span>(fin, tin)) &#123;</span><br><span class="line">      <span class="function">std::ifstream <span class="title">tout</span><span class="params">((*i + <span class="string">&quot;.out&quot;</span>).c_str())</span></span>;</span><br><span class="line">      <span class="keyword">for</span> (<span class="type">char</span> ch = tout.<span class="built_in">get</span>(); ch != <span class="number">-1</span>; ch = tout.<span class="built_in">get</span>()) &#123;</span><br><span class="line">        fout &lt;&lt; ch;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>lemon-autoac-obf.cpp</code>: 半混淆的代码，配合混淆器使用<br>ps: 虽然直接编译也能用<br>ps2: C++没找到什么好用的混淆器，所以这是我人肉混淆的</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> _WIN32</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;io.h&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span>*$<span class="number">1</span>$=<span class="string">&quot;..\\..\\data\\&quot;</span>;std::set&lt;std::string&gt;$<span class="number">2</span>$(<span class="type">const</span> std::string&amp;$<span class="number">3</span>$)&#123;<span class="type">_finddata_t</span> $<span class="number">4</span>$;std::set&lt;std::string&gt;$<span class="number">5</span>$;<span class="type">intptr_t</span> $<span class="number">6</span>$=_findfirst(($<span class="number">3</span>$+<span class="string">&quot;\\*&quot;</span>).<span class="built_in">c_str</span>(),&amp;$<span class="number">4</span>$);<span class="keyword">while</span>(!_findnext($<span class="number">6</span>$,&amp;$<span class="number">4</span>$))&#123;std::string $<span class="number">7</span>$=$<span class="number">4</span>$.name;<span class="keyword">if</span>($<span class="number">7</span>$.<span class="built_in">length</span>()&gt;<span class="number">3</span>&amp;&amp;$<span class="number">7</span>$.<span class="built_in">substr</span>($<span class="number">7</span>$.<span class="built_in">length</span>()<span class="number">-3</span>)==<span class="string">&quot;.in&quot;</span>)&#123;std::string $<span class="number">14</span>$=$<span class="number">3</span>$+<span class="string">&#x27;\\&#x27;</span>+$<span class="number">7</span>$;$<span class="number">5</span>$.<span class="built_in">insert</span>($<span class="number">14</span>$.<span class="built_in">substr</span>(<span class="number">0</span>,$<span class="number">14</span>$.<span class="built_in">length</span>()<span class="number">-3</span>));&#125;&#125;_findclose($<span class="number">6</span>$);<span class="keyword">return</span> $<span class="number">5</span>$;&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;dirent.h&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">char</span>*$<span class="number">1</span>$=<span class="string">&quot;../../data/&quot;</span>;std::set&lt;std::string&gt;$<span class="number">2</span>$(<span class="type">const</span> std::string&amp;$<span class="number">8</span>$)&#123;DIR*$<span class="number">9</span>$=<span class="built_in">opendir</span>($<span class="number">8</span>$.<span class="built_in">c_str</span>());std::set&lt;std::string&gt;$<span class="number">10</span>$;<span class="keyword">for</span>(dirent*$<span class="number">11</span>$=<span class="built_in">readdir</span>($<span class="number">9</span>$);$<span class="number">11</span>$!=<span class="literal">NULL</span>;$<span class="number">11</span>$=<span class="built_in">readdir</span>($<span class="number">9</span>$))&#123;std::string $<span class="number">12</span>$=$<span class="number">11</span>$-&gt;d_name;<span class="keyword">if</span>($<span class="number">12</span>$.<span class="built_in">length</span>()&gt;<span class="number">3</span>&amp;&amp;$<span class="number">12</span>$.<span class="built_in">substr</span>($<span class="number">12</span>$.<span class="built_in">length</span>()<span class="number">-3</span>)==<span class="string">&quot;.in&quot;</span>)&#123;std::string $<span class="number">13</span>$=$<span class="number">8</span>$+<span class="string">&#x27;/&#x27;</span>+$<span class="number">12</span>$;$<span class="number">10</span>$.<span class="built_in">insert</span>($<span class="number">13</span>$.<span class="built_in">substr</span>(<span class="number">0</span>,$<span class="number">13</span>$.<span class="built_in">length</span>()<span class="number">-3</span>));&#125;&#125;<span class="built_in">closedir</span>($<span class="number">9</span>$);<span class="keyword">return</span> $<span class="number">10</span>$;&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="type">const</span> std::string $<span class="number">15</span>$=<span class="string">&quot;$PROBLEM_NAME$&quot;</span>;<span class="type">bool</span> $<span class="number">16</span>$(std::istream&amp;$<span class="number">17</span>$,std::istream&amp;$<span class="number">18</span>$)&#123;$<span class="number">17</span>$.<span class="built_in">seekg</span>(<span class="number">0</span>);<span class="keyword">for</span>(<span class="type">char</span> $<span class="number">19</span>$=$<span class="number">17</span>$.<span class="built_in">get</span>(),$<span class="number">20</span>$=$<span class="number">18</span>$.<span class="built_in">get</span>();$<span class="number">19</span>$!=<span class="number">-1</span>||$<span class="number">20</span>$!=<span class="number">-1</span>;$<span class="number">19</span>$=$<span class="number">17</span>$.<span class="built_in">get</span>(),$<span class="number">20</span>$=$<span class="number">18</span>$.<span class="built_in">get</span>())&#123;<span class="keyword">if</span>($<span class="number">19</span>$!=$<span class="number">20</span>$)&#123;<span class="keyword">return</span> <span class="literal">false</span>;&#125;&#125;<span class="keyword">return</span> <span class="literal">true</span>;&#125;<span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;std::ifstream $<span class="number">21</span>$(($<span class="number">15</span>$+<span class="string">&quot;.in&quot;</span>).<span class="built_in">c_str</span>());std::ofstream $<span class="number">22</span>$(($<span class="number">15</span>$+<span class="string">&quot;.out&quot;</span>).<span class="built_in">c_str</span>());std::set&lt;std::string&gt;$<span class="number">23</span>$=$<span class="number">2</span>$($<span class="number">1</span>$+$<span class="number">15</span>$);<span class="keyword">for</span>(std::set&lt;std::string&gt;::iterator $<span class="number">25</span>$=$<span class="number">23</span>$.<span class="built_in">begin</span>(),$<span class="number">26</span>$=$<span class="number">23</span>$.<span class="built_in">end</span>();$<span class="number">25</span>$!=$<span class="number">26</span>$;$<span class="number">25</span>$++)&#123;std::ifstream $<span class="number">24</span>$((*$<span class="number">25</span>$+<span class="string">&quot;.in&quot;</span>).<span class="built_in">c_str</span>());<span class="keyword">if</span>($<span class="number">16</span>$($<span class="number">21</span>$,$<span class="number">24</span>$))&#123;std::ifstream $<span class="number">27</span>$((*$<span class="number">25</span>$+<span class="string">&quot;.out&quot;</span>).<span class="built_in">c_str</span>());<span class="keyword">for</span>(<span class="type">char</span> $<span class="number">28</span>$=$<span class="number">27</span>$.<span class="built_in">get</span>();$<span class="number">28</span>$!=<span class="number">-1</span>;$<span class="number">28</span>$=$<span class="number">27</span>$.<span class="built_in">get</span>())&#123;$<span class="number">22</span>$&lt;&lt;$<span class="number">28</span>$;&#125;<span class="keyword">return</span> <span class="number">0</span>;&#125;&#125;<span class="keyword">return</span> <span class="number">1</span>;&#125;</span><br></pre></td></tr></table></figure><p><code>lemon-autoac-make.cpp</code>: 混淆器</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;chrono&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"></span><br><span class="line">std::default_random_engine rnd;</span><br><span class="line"><span class="function">std::uniform_int_distribution&lt;<span class="type">int</span>&gt; <span class="title">uni</span><span class="params">(<span class="number">0</span>, <span class="number">15</span>)</span></span>;</span><br><span class="line"><span class="function">std::uniform_int_distribution&lt;<span class="type">int</span>&gt; <span class="title">uni2</span><span class="params">(<span class="number">10</span>, <span class="number">15</span>)</span></span>;</span><br><span class="line"><span class="function">std::string <span class="title">uuid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  std::ostringstream str;</span><br><span class="line">  <span class="type">char</span> ch = <span class="built_in">uni2</span>(rnd);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (ch &lt; <span class="number">10</span>) &#123;</span><br><span class="line">      str &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">char</span>&gt;(ch + <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      str &lt;&lt; <span class="built_in">static_cast</span>&lt;<span class="type">char</span>&gt;(ch - <span class="number">10</span> + <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    ch = <span class="built_in">uni</span>(rnd);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> str.<span class="built_in">str</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">std::string <span class="title">read</span><span class="params">(std::istream&amp; ins)</span> </span>&#123;</span><br><span class="line">  std::ostringstream str;</span><br><span class="line">  str &lt;&lt; ins.<span class="built_in">rdbuf</span>();</span><br><span class="line">  <span class="keyword">return</span> str.<span class="built_in">str</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  rnd.<span class="built_in">seed</span>(std::chrono::steady_clock::<span class="built_in">now</span>().<span class="built_in">time_since_epoch</span>().<span class="built_in">count</span>());</span><br><span class="line">  <span class="function">std::ifstream <span class="title">fin</span><span class="params">(<span class="string">&quot;lemon-autoac-obf.cpp&quot;</span>)</span></span>;</span><br><span class="line">  std::string content = <span class="built_in">read</span>(fin);</span><br><span class="line">  std::string probname;</span><br><span class="line">  std::cout &lt;&lt; <span class="string">&quot;Problem Name: &quot;</span>;</span><br><span class="line">  std::<span class="built_in">getline</span>(std::cin, probname);</span><br><span class="line">  <span class="function">std::ofstream <span class="title">fout</span><span class="params">(probname + <span class="string">&quot;.cpp&quot;</span>)</span></span>;</span><br><span class="line">  content.<span class="built_in">replace</span>(content.<span class="built_in">find</span>(<span class="string">&quot;$PROBLEM_NAME$&quot;</span>), <span class="number">14</span>, probname);</span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>;; i++) &#123;</span><br><span class="line">    std::ostringstream str;</span><br><span class="line">    str &lt;&lt; <span class="string">&#x27;$&#x27;</span> &lt;&lt; i &lt;&lt; <span class="string">&#x27;$&#x27;</span>;</span><br><span class="line">    std::string pattern = str.<span class="built_in">str</span>();</span><br><span class="line">    std::string replacement = <span class="built_in">uuid</span>();</span><br><span class="line">    <span class="type">int</span> plen = pattern.<span class="built_in">length</span>();</span><br><span class="line">    <span class="type">int</span> pos = content.<span class="built_in">find</span>(pattern);</span><br><span class="line">    <span class="keyword">if</span> (pos == <span class="number">-1</span>) &#123;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (pos != <span class="number">-1</span>) &#123;</span><br><span class="line">      content.<span class="built_in">replace</span>(pos, plen, replacement);</span><br><span class="line">      pos = content.<span class="built_in">find</span>(pattern);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  fout &lt;&lt; content;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div></div></article><div class="container giscus-wrap"><script id="giscus-script" data-repo="su226/su226.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkxOTgzMjQyNTk=" data-category="Announcements" data-category-id="DIC_kwDOC9IwI84B_VPa" data-mapping="pathname" data-reactions-enabled="1" data-emit-metadata="0" data-lang="zh-CN" data-theme="light" crossorigin="anonymous" async></script></div><div id="footer">由 <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> 强力驱动，托管于 <a target="_blank" rel="noopener" href="https://vercel.com/">Vercel</a>（<a target="_blank" rel="noopener" href="https://gh.su226.tk">备用线路</a>托管于 <a target="_blank" rel="noopener" href="https://pages.github.com/">Github Pages</a>）</div></div><ul id="settings-dialog"><li data-select="scheme" data-default="auto"><button data-option="auto"><span class="iconify" data-icon="mdi:check"></span></button> <button data-option="multi"><span class="iconify" data-icon="mdi:check"></span></button> <button data-option="single"><span class="iconify" data-icon="mdi:check"></span></button> <button data-option="sepia"><span class="iconify" data-icon="mdi:check"></span></button> <button data-option="dark"><span class="iconify" data-icon="mdi:check"></span></button></li><li data-select="font" data-default="sans"><button data-option="sans">Aa</button> <button data-option="serif">Aa</button> <button data-option="mono">Aa</button></li><li><div data-adjust="size"><button data-minus><span class="iconify" data-icon="mdi:minus"></span></button><div class="subgroup-label"><span class="iconify" data-icon="mdi:format-size"></span><span data-label></span></div><button data-plus><span class="iconify" data-icon="mdi:plus"></span></button></div><div data-adjust="width"><button data-minus><span class="iconify" data-icon="mdi:minus"></span></button><div class="subgroup-label"><span class="iconify" data-icon="mdi:arrow-left-right"></span><span data-label></span></div><button data-plus><span class="iconify" data-icon="mdi:plus"></span></button></div><div data-adjust="line"><button data-minus><span class="iconify" data-icon="mdi:minus"></span></button><div class="subgroup-label"><span class="iconify" data-icon="mdi:arrow-expand-vertical"></span><span data-label></span></div><button data-plus><span class="iconify" data-icon="mdi:plus"></span></button></div></li></ul><script src="https://polyfill.io/v3/polyfill.min.js?features=Array.from%2CArray.prototype.%40%40iterator%2Cdocument.currentScript%2CPromise%2Cfetch%2CElement.prototype.replaceWith%2CElement.prototype.classList%2CElement.prototype.remove%2Cwindow.scroll%2CCustomEvent%2CObject.values%2CObject.entries"></script><script src="https://code.iconify.design/2/2.0.4/iconify.min.js" async></script><script src="/js/waves-0.7.6-min.js"></script><script src="/js/regenerator-runtime-0.13.9-min.js"></script><script src="/js/base.js"></script><script src="/js/post.js"></script></body></html>